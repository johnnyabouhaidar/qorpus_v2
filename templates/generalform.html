<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ajouter Nouveau: {{module_name}}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>

<body class="margin0">
  <!--   <div><a href="{{url_for('dashboard')}}"><img src="./../static/back-btn.png" class="back-btn"></a> </div>

    <h1 class="header">Ajouter Nouveau {{module_name}}</h1> -->


 <div class="row-view">

        <!-- <h2>
        Qu'est-ce que tu aimerais faire?
    </h2> -->
    <div class="allMenu">
        <ul>
            <div class="padding">
                <a href="{{url_for('dashboard')}}" ><img class="img" src="./../static/logo.png" alt="Trulli" width="230" height="auto" /></a>
            </div>
            <br />
            {%if user_role == 'admin'%}
            <!-- <li><a href="{{url_for('user')}}"><span class="white">Gestion des Utilisateurs</span></a></li> -->
            <li> <a href="{{url_for('setup')}}"><span class="iconMenu"><img src="./../static/configuration.svg" alt="Configuration" width="20" height="20" /></span><span class="white">Configuration des Constantes</span></a></li>
            {%endif%}
            <li><a href="{{url_for('doctor')}}"><span class="iconMenu"><img src="./../static/medecine.svg" alt="Medecine" width="20" height="20" /></span><span class="white">Param√®tre du M√©decin</span></a></li>
              <hr />
            <li><a href="{{url_for('payment')}}"><span class="iconMenu"><img src="./../static/donnees-paiment.svg" alt="Paiement" width="20" height="20" /></span><span class="white">Paiements</span></a></li>
            <li><a href="{{url_for('facturation')}}"><span class="iconMenu"><img src="./../static/facturation.svg" alt="Facturation" width="20" height="20" /></span><span class="white">Facturation</span></a></li>
            <li><a href="{{url_for('retrocession')}}"><span class="iconMenu"><img src="./../static/facturation.svg" alt="Retrocession" width="20" height="20" /></span><span class="white">Retrocession</span></a></li>
            <li><a href="{{url_for('fraismateriel')}}"><span class="iconMenu"><img src="./../static/frais.svg" alt="Frais Mat√©riele" width="20" height="20" /></span><span class="white">Frais Materi√®l Medical</span></a></li>
            <li><a href="{{url_for('dentisterie')}}"><span class="iconMenu"><img src="./../static/donnees-dentaire.svg" alt="Donnees Dentaire" width="20" height="20" /></span><span class="white">Dentisterie</span></a></li>
            <hr />
            <li><a href="{{url_for('encaissement')}}"><span class="iconMenu"><img src="./../static/encaissement.svg" alt="Encaissements Avance" width="20" height="20" /></span><span class="white">Encaissements-Avance</span></a></li>
            <li><a href="{{url_for('doctorpayment')}}"><span class="iconMenu"><img src="./../static/paiment-med.svg" alt="Paiement M√©decin" width="20" height="20" /></span><span class="white">Materi√®l/Mobilier</span></a></li>
            <hr />
            <li class="rapportTab"><a href="{{url_for('reporting')}}">G√©n√©ration de Rapports</a></li>
            <!-- <hr /> -->
            <!-- <li><a href="{{url_for('logout')}}"><span class="white">D√©connecter</span></a></li> -->
        </ul>
    </div>
        <div class="bodyCont padding10px bgGrey">
 <div class="header-content">
          <div class="dash-title">Ajouter Nouveau {{module_name}}</div>
        </div>
    <!-- The Modal -->
    <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <span class="close">&times;</span>
            {% for form in forms %}
            <div class="margin-top"></div>
            <div>
                {%set form_id=loop.index0%}
                <div class="section-view">
                    <form method="POST" action="" id="{{form_id}}">
                        <tr>
                            {% for field in form %}
                            <span class="form-titles">{%if field.label.text != 'Soumettre' and field.label.text !=
                                "CSRF Token" %}{{ field.label }}{%else%}{%endif%} {% if field.flags.required %}*{%
                                endif %}</span>
                            {{ field(form=form_id) }}<br><br>
                            {% endfor %}
                            <br><br>
                        </tr>
                    </form>
                </div>
            </div>
            {%endfor%}
        </div>
    </div>
    <div id="analyticsModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <span id="analyticsclose" class="close">&times;</span>
            {% for form in forms %}
            <div class="margin-top"></div>
            <div>
                Fonctionnalit√© √† venir
            </div>
            {%endfor%}
        </div>
    </div>    

    <!-- <a href="{{url_for('dashboard')}}">ü†ê BACK</a> -->

    {%with messages = get_flashed_messages() %}
    {%if messages %}
    {%for message in messages %}
    {{message}}
    {%endfor%}
    {%endif%}
    {%endwith%}
    <div>


        <div>
            <!-- <button type="button" class="collapsible">+ Ajouter Nouveau</button> -->
            <!-- <div class="content">
                {% for form in forms %}
                <div class="margin-top"></div>

                <div>

                    {%set form_id=loop.index0%}
                    <div class="section-view">

                        <form method="POST" action="" id="{{form_id}}">
                            <tr>
                                {% for field in form %}

                                <span class="form-titles">{%if field.label.text != 'Submit' and field.label.text !=
                                    "CSRF Token" %}{{ field.label }}{%else%}{%endif%} {% if field.flags.required %}*{%
                                    endif %}</span>
                                {{ field(form=form_id) }}<br><br>


                                {% endfor %}
                                <br><br>
                            </tr>
                        </form>
                    </div>
                </div>

                {%endfor%}
            </div> -->
            <button id="analyticsBtn" type="button" onclick="" class="viewanalytics-btn"></button>
            <div class="margin-top"></div>
            <div class="">
                
                
                {%if filtervalid_form%}
                <div class="filter-section-view">
                    <form method="POST" action="" id="filtervalidformid" class="validformfilter">
                        
                        
                        {{filtervalid_form.validity(class="validdropdown")}}
                        &emsp;&emsp;&emsp;
                        {{filtervalid_form.fromdate.label}}
                        {{filtervalid_form.fromdate(class="")}}
                        {{filtervalid_form.todate.label}}
                        {{filtervalid_form.todate(class="")}}
                        <br>
                        <br>
                        {{filtervalid_form.amountfrom.label}}
                        {{filtervalid_form.amountfrom(class="")}}
                        &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
                        {{filtervalid_form.amountto.label}}
                        {{filtervalid_form.amountto(class="")}}                                                
    
                        {{filtervalid_form.sub()}}
                        {{filtervalid_form.hidden_tag()}}
                    
                </form>
            </div>
                {%endif%}
            
            
        </div>
        
       
        <div class="flex-row">
                
           
            
            {%set form_id=777%}

            <form method="POST" action="" id="{{form_id}}">
            
            {% for field in export_form %}
            
            {%if field.label.text != 'Soumettre' and field.label.text !=
                "CSRF Token" %}{{ field.label }}{%else%}{%endif%} {% if field.flags.required %}*{%
                endif %}
            {{ field(form=form_id) }}

            
        
                    
        
            {% endfor %}
            
            </form>
            
            
            
        </div>
        
        <br>
        
            <div class="flex-row float-right">
                
                <div class="add-icon-view">
                    <img id="myBtn" class="cursor-pointer" src="./../static/add-icon.png" alt="Dialog" width="30"
                        height="30" />
                </div>
                &nbsp;&nbsp;&nbsp;

                <div>

                    {%if searchform%}
                    <form method="POST" action="" id="searchformid">
                        {{searchform.searchstring}}
                        {{searchform.searchfilter}}
                        {{searchform.searchsubmit}}

                        {{searchform.hidden_tag()}}
                    </form>
                    {%endif%}
                </div><br>

            </div>

            


            
            {%if table|length !=0%}
            <div class="tableCover">

                <table class="fl-table" border="1">
                    <thead>
                        <tr>
                            {%for title in headers%}
                            <th>{{title}}</th>
                            {%endfor%}
                            <th></th>
                            <th></th>
                        </tr>

                    </thead>
                    {% for value in table %}
                    <tr>
                        {%for item in value%}
                        <td>
                            {{item}}
                        </td>
                        
                        {%endfor%}
                        {%if user_role == 'admin'%}

                        <td><a class="ic-view" href="{{url_for('edit_entry',tbl=dbtable,id=value[0])}}"><span><img
                                        src="./../static/icons8-edit.svg" alt="Edit" width="26"
                                        height="26" /></span></a></td>
                        <td><a onclick="document.getElementById('modal{{value[0]}}').style.display='block'"  class="ic-view"  ><span ><img
                                        src="./../static/icons8-trash.svg" alt="Delete" width="26"
                                        height="26" /></span></a></td>

                                        <div id="modal{{value[0]}}" class="modal">
                                            <div class="modal-content-delete">

                                            <span onclick="document.getElementById('modal{{value[0]}}').style.display='none'" class="close" title="Close Modal">&times;</span>
                                            <form action="/action_page.php">
                                              <div class="container_modaldelete">
                                                <h1>Supprimer le compte</h1>
                                                <p>√ätes-vous s√ªr que vous voulez supprimer?</p>
                                          
                                                <div class="clearfix">
                                                  <a onclick="document.getElementById('modal{{value[0]}}').style.display='none'" type="button" class="cancelbtn">Annuler</a>
                                                  <a href="{{url_for('delete_entry',tbl=dbtable,tblid=dbtableid,id=value[0])}}" type="button" class="deletebtn">Effacer</a>
                                                </div>
                                              </div>
                                            </form>
                                            </div>
                                          </div>
                        {%if value[-1] == 'pasvalide'%}
                        <td><a class="table-btn-valider" href="{{url_for('validate_entry',tbl=dbtable,tblid=dbtableid,id=value[0])}}"><span>‚úî Valider 
                            </span></a></td>
                        {%endif%}
                        {%endif%}
                    </tr>
                    {% endfor %}
                </table>
            </div>

            {%endif%}
        </div>

    </div>
    </div>
    </div>
</div>
    <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        var analyticsModal = document.getElementById("analyticsModal");

        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        var analyticsbtn=document.getElementById("analyticsBtn");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        var analyticsspanclose = document.getElementById("analyticsclose");


        // When the user clicks the button, open the modal 
        btn.onclick = function () {
            modal.style.display = "block";
        }
        analyticsbtn.onclick = function () {
            analyticsModal.style.display = "block";
        }

        // When the user clicks on <span> (x), close the modal
        span.onclick = function () {
            modal.style.display = "none";
        }
        analyticsspanclose.onclick = function () {
            analyticsModal.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
                
            }
            if (event.target == analyticsModal){
                analyticsModal.style.display = "none";
            }
        }
   </script>
    {%if hasDynamicSelector == True and dbtable == 'fraismateriel'%}
    <script>
        let fraismaterieltype_select = document.getElementById('fraismaterieltype');
        let fraismaterielname_select = document.getElementById('fraismaterielnom');

        fraismaterieltype_select.onclick = function () {
            fraismaterieltype = fraismaterieltype_select.value;
            
            fetch('/fraismaterielname/' + encodeURI(fraismaterieltype.trim()).toString().replaceAll('%','*')).then(function (response) {
                response.json().then(function (data) {
                    let optionHTML = '';

                    optionHTML += "<option value='addnew'>Ajouter nouveau ?</option>";
                    for (let fraismateriel of data.fraismaterielnames) {
                        optionHTML += '<option value="' + fraismateriel.name + '">' + fraismateriel.name + '</option>';
                    }

                    fraismaterielname_select.innerHTML = optionHTML;
                });
            });
        }
    </script>
    {%endif%}

    {%if hasDynamicSelector == True and dbtable == 'payment'%}
    <script>
        let paymenttype_select = document.getElementById('paiementsType');
        let paymentname_select = document.getElementById('paiementsNom');

        paymenttype_select.onclick = function () {
            paymenttype = paymenttype_select.value;

            fetch('/paymentnames/' + encodeURI(paymenttype.trim()).toString().replaceAll('%','*')).then(function (response) {
                response.json().then(function (data) {
                    let optionHTML = '';

                    optionHTML += "<option value='addnew'>Ajouter nouveau ?</option>";
                    for (let paymentname of data.paymentnames) {
                        optionHTML += '<option value="' + paymentname.name + '">' + paymentname.name + '</option>';
                    }

                    paymentname_select.innerHTML = optionHTML;
                });
            });
        }
    </script>
    {%endif%}
    {%if hasDynamicSelector == True and dbtable == 'facturation'%}
    <script>
        let facturationtype_select = document.getElementById('facturationType');
        let facturationname_select = document.getElementById('facturationNom');

        facturationtype_select.onclick = function () {
            facturationtype = facturationtype_select.value;

            fetch('/facturationnames/' + encodeURI(facturationtype.trim()).toString().replaceAll('%','*')).then(function (response) {
                response.json().then(function (data) {
                    let optionHTML = '';

                    optionHTML += "<option value='addnew'>Ajouter nouveau ?</option>";
                    for (let facturationname of data.facturationnames) {
                        optionHTML += '<option value="' + facturationname.name + '">' + facturationname.name + '</option>';
                    }

                    facturationname_select.innerHTML = optionHTML;
                });
            });
        }
    </script>
    {%endif%}
    {%if hasDynamicSelector == True and dbtable == 'dentisterie'%}
    <script>
        let dentisterietype_select = document.getElementById('dentisterieType');
        let dentisteriename_select = document.getElementById('dentisterieNom');

        dentisterietype_select.onclick = function () {
            dentisterietype = dentisterietype_select.value;

            fetch('/dentisterienames/' + encodeURI(dentisterietype.trim()).toString().replaceAll('%','*')).then(function (response) {
                response.json().then(function (data) {
                    let optionHTML = '';

                    optionHTML += "<option value='addnew'>Ajouter nouveau ?</option>";
                    for (let dentisteriename of data.dentisterienames) {
                        optionHTML += '<option value="' + dentisteriename.name + '">' + dentisteriename.name + '</option>';
                    }

                    dentisteriename_select.innerHTML = optionHTML;
                });
            });
        }
    </script>
    {%endif%}
    {%if hasDynamicSelector == True and dbtable == 'retrocession'%}
    <script>
        let retrocessiontype_select = document.getElementById('retrocessionType');
        let retrocessionname_select = document.getElementById('retrocessionNom');

        retrocessiontype_select.onclick = function () {
            retrocessiontype = retrocessiontype_select.value;

            fetch('/retrocessionnames/' + encodeURI(retrocessiontype.trim()).toString().replaceAll('%','*').replaceAll('/','~')).then(function (response) {
                response.json().then(function (data) {
                    let optionHTML = '';

                    optionHTML += "<option value='addnew'>Ajouter nouveau ?</option>";
                    for (let retrocessionname of data.retrocessionnames) {
                        optionHTML += '<option value="' + retrocessionname.name + '">' + retrocessionname.name + '</option>';
                    }

                    retrocessionname_select.innerHTML = optionHTML;
                });
            });
        }
    </script>
    {%endif%}


    <script>
        var coll = document.getElementsByClassName("collapsible");
        var i;

        for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function () {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            });
        } 
    </script>
    <style>
        .content {
            padding: 0 18px;
            background-color: white;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
        }
    </style>

    <script>
        var coll = document.getElementsByClassName("collapsible");
        var i;

        for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function () {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.maxHeight) {
                    content.style.maxHeight = null;
                } else {
                    content.style.maxHeight = content.scrollHeight + "px";
                }
            });
        }
    </script> 
</body>

</html>